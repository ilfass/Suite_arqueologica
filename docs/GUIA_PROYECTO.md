# ğŸ“š GUÃA DEL PROYECTO: Suite ArqueolÃ³gica

Esta guÃ­a es el punto de referencia para cualquier desarrollador, asistente o usuario tÃ©cnico que trabaje con este sistema. AquÃ­ encontrarÃ¡s TODO lo esencial para evitar errores, ahorrar tiempo y mantener buenas prÃ¡cticas.

---

## ğŸŒ ECOSISTEMA ARQUEOLÃ“GICO GLOBAL

### **VisiÃ³n y Contexto**

La Suite ArqueolÃ³gica se posiciona como una plataforma integral que conecta y optimiza el ecosistema arqueolÃ³gico global, facilitando la colaboraciÃ³n entre diferentes actores y mejorando la eficiencia en la gestiÃ³n de proyectos arqueolÃ³gicos.

### **ğŸ›ï¸ Actores del Ecosistema**

#### **Instituciones AcadÃ©micas**
- **Universidades** â†’ FormaciÃ³n de estudiantes, investigaciÃ³n acadÃ©mica
- **Institutos de InvestigaciÃ³n** â†’ Proyectos cientÃ­ficos especializados
- **Laboratorios** â†’ AnÃ¡lisis de materiales, dataciÃ³n, conservaciÃ³n

#### **Organismos Gubernamentales**
- **INAH (MÃ©xico)** â†’ ProtecciÃ³n y gestiÃ³n del patrimonio arqueolÃ³gico
- **Ministerios de Cultura** â†’ PolÃ­ticas pÃºblicas y regulaciones
- **SecretarÃ­as de Turismo** â†’ Desarrollo turÃ­stico sostenible

#### **Organizaciones Internacionales**
- **UNESCO** â†’ Patrimonio mundial, estÃ¡ndares internacionales
- **ICOMOS** â†’ ConservaciÃ³n del patrimonio cultural
- **ICOM** â†’ Museos y colecciones

#### **Sector Privado**
- **Consultoras ArqueolÃ³gicas** â†’ Servicios profesionales
- **Empresas de ConstrucciÃ³n** â†’ ArqueologÃ­a preventiva
- **Desarrolladores TurÃ­sticos** â†’ Proyectos sostenibles

#### **Comunidades Locales**
- **Pueblos Originarios** â†’ Conocimiento tradicional
- **Comunidades Rurales** â†’ ParticipaciÃ³n y beneficios locales
- **Organizaciones Civiles** â†’ Defensa del patrimonio

### **ğŸ”¬ Tipos de Proyectos ArqueolÃ³gicos**

#### **InvestigaciÃ³n AcadÃ©mica**
- **Excavaciones SistemÃ¡ticas** â†’ MetodologÃ­a cientÃ­fica rigurosa
- **Prospecciones ArqueolÃ³gicas** â†’ IdentificaciÃ³n de sitios
- **AnÃ¡lisis de Laboratorio** â†’ Estudios especializados
- **Publicaciones CientÃ­ficas** â†’ DifusiÃ³n de resultados

#### **ArqueologÃ­a Preventiva**
- **Evaluaciones de Impacto** â†’ Antes de obras de infraestructura
- **Rescates ArqueolÃ³gicos** â†’ Salvamento de sitios amenazados
- **Monitoreo de Obras** â†’ SupervisiÃ³n durante construcciÃ³n

#### **ConservaciÃ³n y RestauraciÃ³n**
- **ConservaciÃ³n Preventiva** â†’ Mantenimiento de sitios
- **RestauraciÃ³n ArquitectÃ³nica** â†’ RehabilitaciÃ³n de estructuras
- **ConservaciÃ³n de Materiales** â†’ Tratamiento de artefactos

#### **DifusiÃ³n y EducaciÃ³n**
- **Museos y Exposiciones** â†’ ExhibiciÃ³n pÃºblica
- **Programas Educativos** â†’ FormaciÃ³n de pÃºblicos
- **Turismo Cultural** â†’ Visitas guiadas y experiencias

### **ğŸ“Š Flujos de InformaciÃ³n**

#### **RecopilaciÃ³n de Datos**
- **Registro de Campo** â†’ Notas, fotografÃ­as, dibujos
- **DocumentaciÃ³n Digital** â†’ Modelos 3D, GIS, bases de datos
- **AnÃ¡lisis CientÃ­ficos** â†’ DataciÃ³n, anÃ¡lisis de materiales
- **Archivos HistÃ³ricos** â†’ DocumentaciÃ³n previa

#### **Procesamiento y AnÃ¡lisis**
- **Sistemas de InformaciÃ³n GeogrÃ¡fica (GIS)** â†’ AnÃ¡lisis espacial
- **Bases de Datos Relacionales** â†’ OrganizaciÃ³n de informaciÃ³n
- **AnÃ¡lisis EstadÃ­sticos** â†’ InterpretaciÃ³n de datos
- **Modelado 3D** â†’ Reconstrucciones virtuales

#### **DifusiÃ³n y Acceso**
- **Publicaciones AcadÃ©micas** â†’ Revistas especializadas
- **Reportes TÃ©cnicos** â†’ DocumentaciÃ³n oficial
- **Plataformas Digitales** â†’ Acceso pÃºblico
- **Exposiciones** â†’ DifusiÃ³n cultural

### **ğŸ¯ Beneficios del Ecosistema Integrado**

#### **Para Investigadores**
- **ColaboraciÃ³n Global** â†’ Redes de investigaciÃ³n internacionales
- **Acceso a Datos** â†’ InformaciÃ³n compartida y estandarizada
- **Herramientas Avanzadas** â†’ TecnologÃ­as de vanguardia
- **Financiamiento** â†’ Oportunidades de financiaciÃ³n

#### **Para Instituciones**
- **GestiÃ³n Eficiente** â†’ OptimizaciÃ³n de recursos
- **Cumplimiento Normativo** â†’ EstÃ¡ndares internacionales
- **Visibilidad** â†’ Posicionamiento institucional
- **ColaboraciÃ³n** â†’ Alianzas estratÃ©gicas

#### **Para Estudiantes**
- **FormaciÃ³n Integral** â†’ Experiencia prÃ¡ctica y teÃ³rica
- **Redes Profesionales** â†’ Contactos en el sector
- **Acceso a Recursos** â†’ Herramientas y datos
- **Oportunidades Laborales** â†’ InserciÃ³n profesional

#### **Para la Sociedad**
- **PreservaciÃ³n del Patrimonio** â†’ ConservaciÃ³n para futuras generaciones
- **EducaciÃ³n Cultural** â†’ Conocimiento del pasado
- **Desarrollo Sostenible** â†’ Turismo responsable
- **Identidad Cultural** â†’ Fortalecimiento de raÃ­ces

### **ğŸš€ TecnologÃ­as Emergentes**

#### **TecnologÃ­as de Campo**
- **Drones y FotogrametrÃ­a** â†’ DocumentaciÃ³n aÃ©rea
- **EscÃ¡neres 3D** â†’ Registro preciso de estructuras
- **Sensores Remotos** â†’ ProspecciÃ³n no invasiva
- **GPS de Alta PrecisiÃ³n** â†’ GeorreferenciaciÃ³n exacta

#### **AnÃ¡lisis Digital**
- **Inteligencia Artificial** â†’ ClasificaciÃ³n automÃ¡tica
- **Machine Learning** â†’ PredicciÃ³n de patrones
- **Big Data** â†’ AnÃ¡lisis masivo de informaciÃ³n
- **Realidad Virtual/Aumentada** â†’ Experiencias inmersivas

#### **GestiÃ³n de Datos**
- **Bases de Datos Distribuidas** â†’ Acceso global
- **Blockchain** â†’ Trazabilidad de informaciÃ³n
- **Cloud Computing** â†’ Procesamiento en la nube
- **APIs Interoperables** â†’ IntegraciÃ³n de sistemas

### **ğŸ“ˆ MÃ©tricas de Ã‰xito**

#### **Indicadores Cuantitativos**
- **NÃºmero de Proyectos** â†’ Actividad arqueolÃ³gica
- **Sitios Documentados** â†’ Cobertura geogrÃ¡fica
- **Publicaciones Generadas** â†’ ProducciÃ³n acadÃ©mica
- **Usuarios Activos** â†’ AdopciÃ³n de la plataforma

#### **Indicadores Cualitativos**
- **Calidad de InvestigaciÃ³n** â†’ Rigor cientÃ­fico
- **ColaboraciÃ³n Interinstitucional** â†’ Trabajo en red
- **Impacto Social** â†’ Beneficios comunitarios
- **InnovaciÃ³n TecnolÃ³gica** â†’ Avances metodolÃ³gicos

---

## ğŸ’¼ MODELO DE NEGOCIO Y ROLES

### **ğŸ­ Sistema de Roles y Permisos**

#### **ADMIN (Administrador del Sistema)**
- **Responsabilidades:**
  - GestiÃ³n completa del sistema y usuarios
  - AdministraciÃ³n de instituciones y suscripciones
  - Reportes del sistema y mÃ©tricas globales
  - ConfiguraciÃ³n de polÃ­ticas y seguridad
  - SupervisiÃ³n de toda la plataforma

- **Funcionalidades EspecÃ­ficas:**
  - Dashboard con estadÃ­sticas globales
  - GestiÃ³n de usuarios (crear, editar, eliminar, asignar roles)
  - GestiÃ³n de instituciones y suscripciones
  - Reportes del sistema y anÃ¡lisis de uso
  - ConfiguraciÃ³n de polÃ­ticas de seguridad
  - Monitoreo de actividad y auditorÃ­a

#### **RESEARCHER (Investigador)**
- **Responsabilidades:**
  - Liderar proyectos de investigaciÃ³n arqueolÃ³gica
  - Documentar hallazgos y excavaciones
  - Gestionar equipos de trabajo
  - Publicar resultados de investigaciÃ³n
  - Colaborar con otros investigadores

- **Funcionalidades EspecÃ­ficas:**
  - Dashboard con proyectos activos y mÃ©tricas
  - GestiÃ³n completa de sitios arqueolÃ³gicos
  - DocumentaciÃ³n detallada de artefactos
  - Registro y seguimiento de excavaciones
  - GeneraciÃ³n de reportes de investigaciÃ³n
  - Herramientas de anÃ¡lisis y visualizaciÃ³n

#### **DIRECTOR (Director de Proyecto/InstituciÃ³n)**
- **Responsabilidades:**
  - Aprobar proyectos de investigaciÃ³n
  - Supervisar investigadores y equipos
  - Gestionar permisos y autorizaciones
  - Coordinar con instituciones gubernamentales
  - Asegurar cumplimiento normativo

- **Funcionalidades EspecÃ­ficas:**
  - Dashboard de aprobaciones pendientes
  - GestiÃ³n de proyectos y asignaciÃ³n de recursos
  - SupervisiÃ³n de usuarios y equipos
  - CoordinaciÃ³n institucional y reportes
  - GestiÃ³n de permisos y autorizaciones

#### **STUDENT (Estudiante)**
- **Responsabilidades:**
  - Participar en excavaciones y proyectos
  - Tomar notas de campo y documentar
  - Aprender metodologÃ­as arqueolÃ³gicas
  - Acceder a recursos educativos
  - Colaborar en equipos de investigaciÃ³n

- **Funcionalidades EspecÃ­ficas:**
  - Dashboard con tareas asignadas y progreso
  - Sistema de notas de campo digital
  - Tutoriales y recursos educativos
  - Acceso a datos pÃºblicos y bibliografÃ­a
  - Seguimiento de progreso acadÃ©mico
  - Herramientas de colaboraciÃ³n

#### **INSTITUTION (InstituciÃ³n)**
- **Responsabilidades:**
  - Gestionar proyectos institucionales
  - Coordinar investigadores y equipos
  - Generar reportes institucionales
  - Cumplir con normativas y estÃ¡ndares
  - Promover la investigaciÃ³n arqueolÃ³gica

- **Funcionalidades EspecÃ­ficas:**
  - Dashboard institucional con mÃ©tricas
  - GestiÃ³n de proyectos y investigadores
  - Reportes institucionales y financieros
  - Herramientas de coordinaciÃ³n
  - Cumplimiento normativo y auditorÃ­a

#### **GUEST (Invitado)**
- **Responsabilidades:**
  - Explorar datos pÃºblicos
  - InformaciÃ³n general y educativa
  - Sin acceso a funcionalidades privadas
  - DifusiÃ³n cultural

- **Funcionalidades EspecÃ­ficas:**
  - VisualizaciÃ³n de sitios arqueolÃ³gicos pÃºblicos
  - InformaciÃ³n bÃ¡sica de artefactos
  - Datos de excavaciones pÃºblicas
  - Recursos educativos generales
  - Sin capacidad de ediciÃ³n o gestiÃ³n

### **ğŸ’° Modelo de Negocio**

#### **Estructura de Suscripciones**

##### **Plan BÃ¡sico (GRATUITO)**
- **Rol:** GUEST
- **Funcionalidades:**
  - Acceso limitado a datos pÃºblicos
  - InformaciÃ³n bÃ¡sica de sitios arqueolÃ³gicos
  - Recursos educativos generales
  - Sin capacidad de ediciÃ³n

##### **Plan Estudiante (GRATUITO)**
- **Rol:** STUDENT
- **Funcionalidades:**
  - Acceso completo para estudiantes
  - Herramientas educativas avanzadas
  - Sistema de notas de campo
  - Tutoriales y recursos de aprendizaje
  - ColaboraciÃ³n en proyectos

##### **Plan Investigador (PAGO - $29/mes)**
- **Rol:** RESEARCHER
- **Funcionalidades:**
  - Acceso completo a herramientas de investigaciÃ³n
  - GestiÃ³n de proyectos y sitios arqueolÃ³gicos
  - DocumentaciÃ³n avanzada de artefactos
  - Reportes cientÃ­ficos y anÃ¡lisis
  - ColaboraciÃ³n con otros investigadores
  - Herramientas de visualizaciÃ³n 3D

##### **Plan Director (PAGO - $79/mes)**
- **Rol:** DIRECTOR
- **Funcionalidades:**
  - SupervisiÃ³n y aprobaciÃ³n de proyectos
  - GestiÃ³n de equipos y recursos
  - Reportes ejecutivos y mÃ©tricas
  - CoordinaciÃ³n institucional
  - Herramientas de gestiÃ³n avanzada

##### **Plan Institucional (PAGO - $199/mes)**
- **Rol:** INSTITUTION
- **Funcionalidades:**
  - GestiÃ³n de mÃºltiples investigadores
  - Reportes institucionales avanzados
  - Herramientas de coordinaciÃ³n
  - Cumplimiento normativo
  - API para integraciÃ³n con sistemas existentes

##### **Plan Enterprise (PAGO - $499/mes)**
- **Rol:** ADMIN
- **Funcionalidades:**
  - Acceso completo del sistema
  - PersonalizaciÃ³n completa
  - Soporte prioritario
  - IntegraciÃ³n con sistemas externos
  - CapacitaciÃ³n y consultorÃ­a

#### **Fuentes de Ingresos**

##### **Suscripciones Mensuales/Anuales**
- **Investigadores Independientes:** $29/mes
- **Directores de Proyecto:** $79/mes
- **Instituciones AcadÃ©micas:** $199/mes
- **Empresas y Consultoras:** $499/mes

##### **Servicios Profesionales**
- **ImplementaciÃ³n Personalizada:** $5,000 - $50,000
- **CapacitaciÃ³n y ConsultorÃ­a:** $150/hora
- **Desarrollo de MÃ³dulos EspecÃ­ficos:** $10,000 - $100,000
- **MigraciÃ³n de Datos:** $2,000 - $20,000

##### **Servicios de Valor Agregado**
- **AnÃ¡lisis de Datos Avanzado:** $500 - $5,000
- **Reportes Personalizados:** $200 - $2,000
- **IntegraciÃ³n con Sistemas Existentes:** $1,000 - $10,000
- **Soporte TÃ©cnico Premium:** $100/mes

#### **Estrategia de Mercado**

##### **SegmentaciÃ³n de Mercado**
- **AcadÃ©mico:** Universidades, institutos de investigaciÃ³n
- **Gubernamental:** INAH, ministerios de cultura
- **Privado:** Consultoras arqueolÃ³gicas, empresas de construcciÃ³n
- **Educativo:** Estudiantes y profesores
- **Cultural:** Museos, organizaciones sin fines de lucro

##### **Canales de DistribuciÃ³n**
- **Venta Directa:** Sitio web, demos en vivo
- **Partnerships:** Alianzas con instituciones acadÃ©micas
- **Referencias:** Usuarios satisfechos
- **Eventos:** Conferencias arqueolÃ³gicas, ferias

##### **Estrategia de Precios**
- **Freemium:** Acceso bÃ¡sico gratuito para captar usuarios
- **Precios Competitivos:** Por debajo del mercado actual
- **Descuentos Institucionales:** Para universidades y gobiernos
- **Precios por Volumen:** Descuentos para mÃºltiples usuarios

---

## 1. ğŸ“¦ Estructura de Carpetas Clave

- `/backend` â†’ API, lÃ³gica de negocio, conexiÃ³n Supabase
- `/frontend-web` â†’ Frontend web (Next.js)
- `/frontend-mobile` â†’ Frontend mÃ³vil (React Native)
- `/shared` â†’ CÃ³digo y tipos compartidos

---

## 2. ğŸ”‘ Variables de Entorno (ENV)

**UbicaciÃ³n:** `/backend/.env` y `/frontend-web/.env.local`

### Backend (`/backend/.env`):
```bash
# ConfiguraciÃ³n de Supabase (valores de prueba)
SUPABASE_URL=https://avpaiyyjixtdopbciedr.supabase.co
SUPABASE_KEY=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImF2cGFpeXlqaXh0ZG9wYmNpZWRyIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDg2NjAzMjMsImV4cCI6MjA2NDIzNjMyM30.1rreoeSBexWbEKdRtIbSwQcWwD3i53RAqFWt5qe820A
SUPABASE_SERVICE_ROLE_KEY=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImF2cGFpeXlqaXh0ZG9wYmNpZWRyIiwicm9sZSI6InNlcnZpY2Vfcm9sZSIsImlhdCI6MTc0ODY2MDMyMywiZXhwIjoyMDY0MjM2MzIzfQ.jb6t6O2-c0SHv5WAw4F7u93dbGrZ8TKh0UTNzcNEOhc

# ConfiguraciÃ³n del servidor
PORT=4000
NODE_ENV=development

# ConfiguraciÃ³n de JWT
JWT_SECRET=suite_arqueologica_jwt_secret_key_2024
JWT_EXPIRES_IN=7d

# ConfiguraciÃ³n de CORS
CORS_ORIGIN=http://localhost:3000,http://localhost:3001

# ConfiguraciÃ³n de logs
LOG_LEVEL=debug

# ConfiguraciÃ³n de rate limiting
RATE_LIMIT_WINDOW_MS=900000
RATE_LIMIT_MAX_REQUESTS=100
```

### Frontend (`/frontend-web/.env.local`):
```bash
NEXT_PUBLIC_SUPABASE_URL=https://avpaiyyjixtdopbciedr.supabase.co
NEXT_PUBLIC_SUPABASE_ANON_KEY=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImF2cGFpeXlqaXh0ZG9wYmNpZWRyIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDg2NjAzMjMsImV4cCI6MjA2NDIzNjMyM30.1rreoeSBexWbEKdRtIbSwQcWwD3i53RAqFWt5qe820A
BACKEND_URL=http://localhost:4000
```

> **IMPORTANTE:** Nunca subas estos archivos a git. Si cambias las credenciales, actualiza esta guÃ­a.

---

## 3. ğŸ—ºï¸ Rutas y Endpoints Esenciales

### Backend (API REST)
- `POST   /api/auth/login`         â†’ Login de usuario
- `POST   /api/auth/logout`        â†’ Logout
- `GET    /api/sites`              â†’ Listar sitios arqueolÃ³gicos
- `GET    /api/artifacts`          â†’ Listar artefactos
- `GET    /api/excavations`        â†’ Listar excavaciones
- `POST   /api/sites`              â†’ Crear sitio (requiere token)
- `POST   /api/artifacts`          â†’ Crear artefacto (requiere token)
- `POST   /api/excavations`        â†’ Crear excavaciÃ³n (requiere token)
- `GET    /api/health`             â†’ Estado del backend

### Frontend
- `http://localhost:3000`         â†’ Web app
- `http://localhost:3000/login`   â†’ Login
- `http://localhost:3000/dashboard` â†’ Dashboard por rol

---

## 4. ğŸ‘¤ Credenciales de Prueba

| Rol         | Email                        | ContraseÃ±a        |
|-------------|------------------------------|-------------------|
| ADMIN       | fa07fa@gmail.com             | 3por39            |
| RESEARCHER  | dr.perez@unam.mx            | investigador123   |
| STUDENT     | estudiante@universidad.edu   | estudiante123     |
| DIRECTOR    | director@inah.gob.mx         | director123       |
| INSTITUTION | admin@inah.gob.mx            | institucion123    |
| GUEST       | invitado@example.com         | invitado123       |

> **Nota:** Si alguna credencial no funciona, revisa la sincronizaciÃ³n entre Supabase y la tabla `public.users`.

---

## 5. ğŸ—„ï¸ Estructura de Base de Datos

### Tablas Principales
- `public.users` â†’ Usuarios del sistema
- `public.archaeological_sites` â†’ Sitios arqueolÃ³gicos
- `public.artifacts` â†’ Artefactos
- `public.excavations` â†’ Excavaciones
- `public.documents` â†’ Documentos
- `public.measurements` â†’ Mediciones
- `public.site_permissions` â†’ Permisos
- `public.notifications` â†’ Notificaciones

### PolÃ­ticas RLS (Row Level Security)
- **users**: Solo el propio usuario puede ver/editar su perfil
- **archaeological_sites**: Cualquiera puede ver sitios activos
- **artifacts**: Cualquiera puede ver artefactos activos
- **excavations**: Cualquiera puede ver excavaciones activas

### Extensiones Requeridas
- `uuid-ossp` â†’ Para generar UUIDs
- `postgis` â†’ Para datos geogrÃ¡ficos

---

## 6. âš™ï¸ Comandos Ãštiles

### Backend
```bash
cd backend
npm install
npm run dev
```

### Frontend Web
```bash
cd frontend-web
npm install
npm run dev
```

### Pruebas AutomÃ¡ticas
```bash
node test_login_roles_visual.js      # Prueba visual de login
node test_api_roles.js               # Prueba de APIs por rol
```

### Crear Tablas en Supabase
- Ejecuta el contenido de `create_supabase_tables.sql` en el SQL Editor de Supabase si faltan tablas.
- Si usas scripts automÃ¡ticos, asegÃºrate de tener las variables de entorno correctas.

---

## 7. ğŸš¦ Flujo de Trabajo Recomendado

1. **Verifica variables de entorno** en `/backend/.env` y `/frontend-web/.env.local`.
2. **Ejecuta backend y frontend** en terminales separadas.
3. **Corre los scripts de prueba** para login y APIs.
4. **Si hay errores 400/401/403:**
   - Verifica que las tablas existan en Supabase
   - Revisa las polÃ­ticas RLS y los triggers
   - Consulta los logs del backend
5. **Para agregar datos de prueba:**
   - Usa el frontend o scripts SQL
6. **Documenta cualquier cambio importante en esta guÃ­a.**

---

## 8. ğŸ”§ Troubleshooting

### Errores Comunes y Soluciones

#### Error 400: "relation does not exist"
**Problema:** Las tablas no existen en Supabase
**SoluciÃ³n:** 
1. Ve al dashboard de Supabase
2. Navega a SQL Editor
3. Ejecuta el contenido de `create_supabase_tables.sql`

#### Error 401: "No token provided"
**Problema:** Falta token de autenticaciÃ³n
**SoluciÃ³n:** 
1. Verifica que el login funcione
2. Revisa que el token se envÃ­e en el header Authorization
3. Verifica que el JWT_SECRET estÃ© configurado

#### Error 403: "Insufficient permissions"
**Problema:** El usuario no tiene permisos para la acciÃ³n
**SoluciÃ³n:**
1. Verifica el rol del usuario en la tabla `users`
2. Revisa las polÃ­ticas RLS en Supabase
3. Confirma que el usuario estÃ© autenticado

#### Login falla para GUEST
**Problema:** El rol GUEST no estÃ¡ configurado correctamente
**SoluciÃ³n:**
1. Verifica que el usuario exista en `public.users`
2. Confirma que el rol sea 'GUEST'
3. Revisa las polÃ­ticas RLS para usuarios no autenticados

### VerificaciÃ³n de Estado
```bash
# Verificar backend
curl http://localhost:4000/api/health

# Verificar frontend
curl http://localhost:3000

# Verificar tablas en Supabase
# Ve al dashboard de Supabase > Table Editor
```

---

## 9. ğŸ”’ Tips de Seguridad

### Variables de Entorno
- âœ… **Nunca subas credenciales a git**
- âœ… **Usa .env.local para desarrollo**
- âœ… **Rota las claves regularmente**
- âœ… **Usa diferentes claves para desarrollo y producciÃ³n**

### AutenticaciÃ³n
- âœ… **JWT_SECRET debe ser largo y aleatorio**
- âœ… **Configura expiraciÃ³n de tokens**
- âœ… **Usa HTTPS en producciÃ³n**
- âœ… **Implementa rate limiting**

### Base de Datos
- âœ… **Habilita RLS en todas las tablas**
- âœ… **Define polÃ­ticas especÃ­ficas por rol**
- âœ… **Usa Service Role Key solo en el backend**
- âœ… **Anon Key solo para operaciones pÃºblicas**

### API
- âœ… **Valida todos los inputs**
- âœ… **Usa middleware de autenticaciÃ³n**
- âœ… **Implementa logging de errores**
- âœ… **Configura CORS apropiadamente**

---

## 10. ğŸ“ Notas y Buenas PrÃ¡cticas

- **Nunca subas credenciales reales a git.**
- **Actualiza esta guÃ­a** si cambias rutas, credenciales o estructura.
- **Consulta este archivo antes de pedir ayuda o modificar configuraciÃ³n.**
- **Si tienes dudas sobre el flujo, revisa los comandos y rutas aquÃ­ listados.**
- **Para debugging:**
  - Usa los endpoints `/api/health` y `/api` para verificar el estado del backend.
  - Usa los logs del backend para rastrear errores de API.

### Logs Ãštiles
```bash
# Ver logs del backend
cd backend && npm run dev

# Ver logs del frontend
cd frontend-web && npm run dev

# Verificar procesos activos
ps aux | grep -E "(node|npm)" | grep -v grep

# Verificar puertos
lsof -i :3000 -i :4000
```

---

## 11. ğŸ“ Archivos Importantes

- `backend/.env`                  â†’ Variables de entorno backend
- `frontend-web/.env.local`        â†’ Variables de entorno frontend
- `create_supabase_tables.sql`     â†’ Script SQL para crear tablas
- `test_login_roles_visual.js`     â†’ Prueba visual de login
- `test_api_roles.js`              â†’ Prueba de APIs por rol
- `CREDENCIALES_ROLES.md`          â†’ Detalle de roles y permisos
- `ESTADO_SISTEMA.md`              â†’ Estado actual y bitÃ¡cora
- `GUIA_PROYECTO.md`               â†’ Esta guÃ­a

---

## 12. ğŸš€ Comandos de InicializaciÃ³n RÃ¡pida

```bash
# 1. Iniciar backend
cd backend && npm run dev

# 2. En otra terminal, iniciar frontend
cd frontend-web && npm run dev

# 3. Verificar estado
curl http://localhost:4000/api/health
curl http://localhost:3000

# 4. Probar login
node test_login_roles_visual.js

# 5. Probar APIs
node test_api_roles.js
```

---

**Â¡Consulta esta guÃ­a siempre antes de modificar, probar o pedir ayuda!** 